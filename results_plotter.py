import pickle
import matplotlib.pyplot as plt
import pandas as pd

lrs = ['16', '32', '48', '64', '128']

train_losses = []
val_losses = []
df=pd.DataFrame({'32': {'train':[], 'val':[]}, '64': {'train':[], 'val':[]}, '128': {'train':[], 'val':[]} }) 
# '0.1': {'train':[], 'val':[]}, '0.0001': {'train':[], 'val':[]}, '0.00001': {'train':[], 'val':[]} })

# 16 channels,28 batchsize
df['16']['train'] = [0.5739605550642137, 0.4466197057203813, 0.4331734381712876, 0.4285306094528793, 0.4250031036215943, 0.42230498945558226, 0.417718878040066, 0.4169909265134242, 0.4148674707908135, 0.4146684826194466, 0.41018533087396003, 0.40887346747633696, 0.4071243002817228, 0.4069153233007951, 0.40529652462377175, 0.40640893694642305, 0.406134807444238, 0.40370713812964304, 0.40416488709387843, 0.4000877807666729, 0.4032734160299425, 0.40199533143600863, 0.4000553217801181, 0.4012376588660401, 0.39909823529132]
df['16]']['val'] = [0.46227168959456605, 0.43537597609804823, 0.430814883925698, 0.426772834418656, 0.4219222068786621, 0.42577520438602995, 0.4143390392328238, 0.41717719412469245, 0.41931929371573706, 0.412866878819156, 0.40916647152467206, 0.41099063297370814, 0.40572779828851874, 0.4093458203526286, 0.424088737407288, 0.412333738494229, 0.40503432998409516, 0.4040945280681957, 0.40088122850888736, 0.4130400659201981, 0.4051842519215175, 0.40122939085031484, 0.39942779943540496, 0.4003628956807124, 0.40135002600682246]

# 32 channels,14 batchsize
df['32']['train'] =  [0.4825,0.4374,0.4293,0.4218,0.418,0.4138,0.4138,0.4106,0.4095,0.407,0.406,0.4029,0.4034,0.4,0.3997,0.3978,0.3976,0.3943,0.3958,0.3946,0.3941,0.3922,0.393,0.3905,0.3908,0.389,0.3897,0.3887,0.3873]
df['32']['val'] = [0.4372,0.4345,0.425,0.4262,0.4124,0.412,0.4084,0.4109,0.4036,0.4039,0.4009,0.4,0.399,0.3982,0.3963,0.3937,0.3932,0.3931,0.3923,0.3909,0.3916,0.394,0.3912,0.3898,0.3901,0.3888,0.3908,0.3878,0.3889]

# 48 channels, 9 batchsize
df['48']['train'] = [0.4506429306098393, 0.4233549462646997, 0.4117456351508613, 0.4088554878194793, 0.40492522566258404, 0.40205066669888856, 0.40186328046462116, 0.3980664891355178, 0.39638851871009634, 0.3962353520533618, 0.39232808977615935, 0.39195083094244243, 0.39230442898614065, 0.3910497429491091, 0.39103629634159953, 0.38850620363940713, 0.3893770427763963, 0.38803399560832175, 0.3873074209990622, 0.38792632132017313, 0.38738379433375447, 0.3857902904518512, 0.3871732118750821, 0.3867667655484015, 0.3852212596841219]
df['48']['val'] = [0.4403995330594167, 0.4238424038185793, 0.4134760155898182, 0.4191148847091098, 0.4056465475499129, 0.40438003274573, 0.39684873644043417, 0.3969865857052202, 0.3988315493118863, 0.3929152488708496, 0.39087389196668354, 0.3909853173404181, 0.3896590616522717, 0.38934900705553904, 0.3906420101137722, 0.3906196811619927, 0.39300015418469403, 0.3933028248177857, 0.3871643530721424, 0.3888057570497529, 0.3879586112599413, 0.38731287532493847, 0.3891074189117977, 0.38505444406461314, 0.3859363691646512]

# 64 channels, 6 batchsize
df['64']['train'] = [0.4484,0.4249,0.4135,0.4084,0.4052,0.4012,0.4005,0.3975,0.3961,0.3953,0.393,0.3918,0.3933,0.3906,0.3892,0.3896,0.3891,0.3869,0.3871,0.3868,0.3862,0.3858,0.3861,0.3837,0.3842,0.3843,0.3838,0.3829,0.3828,0.3823]
df['64']['val'] = [0.4309,0.4123,0.4101,0.4033,0.4012,0.4002,0.3952,0.3949,0.4011,0.3937,0.392,0.3906,0.389,0.3898,0.3895,0.3894,0.3865,0.3857,0.387,0.3875,0.3858,0.3846,0.3867,0.3831,0.3847,0.3846,0.3818,0.3831,0.3824,0.381]

# 128 channels, 3 batchsize
df['128']['train'] = pickle.load(open(f"./vary-ch/pickle/UNET-B3-e30-ch128-ssim-adam-train.pkl",'rb'))
df['128']['val'] = pickle.load(open(f"./vary-ch/pickle/UNET-B3-e30-ch128-ssim-adam-val.pkl", 'rb'))


plt.xlabel('Epochs')
plt.ylabel('loss, DSSIM')
colours = ['b','g','r','c','m']

for lr in lrs:
    for phase in df[lr].keys():
        if phase == 'val':
            plt.plot(df[lr][phase], label=f"{lr} {phase}",linestyle='dashed',color=colours[list(df.keys()).index(lr)])
        else:
            plt.plot(df[lr][phase], label=f"{lr} {phase}",color=colours[list(df.keys()).index(lr)])
# plt.ylim(0,max(TRAIN_LOSS))
plt.title('Loss against epoch number for large channels')
plt.legend()
# plt.plot(TRAIN_LOSS,'b-')
# plt.plot(VAL_LOSS,'r-')
# plt.savefig(f"./vary-optim/plots/{optimiser}.png")
plt.savefig(f"./vary-ch/plots/channels.png")
plt.show()



